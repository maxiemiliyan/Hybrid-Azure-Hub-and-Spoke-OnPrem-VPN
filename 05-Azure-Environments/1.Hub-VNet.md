# Azure Hub Virtual Network (Hub VNet)

## Overview

The **Azure Hub Virtual Network (Hub VNet)** acts as the **central connectivity and security control point** for the entire hybrid architecture.  
All traffic between **on-premises**, **Application VNet**, and **Management VNet** is routed through the Hub VNet.

No workloads are deployed in the Hub. It exists only to host **shared networking and security services**.

---

## Purpose of the Hub VNet

The Hub VNet is designed to:

- Centralize hybrid connectivity with on-premises
- Enforce mandatory traffic inspection
- Control routing between isolated spoke networks
- Provide a scalable foundation for additional VNets or services

This design aligns with **enterprise Azure Hub-and-Spoke best practices**.

---

## Hub VNet Address Space

| Component | Address Range |
|---------|---------------|
| Hub VNet | `10.1.0.0/16` |
| Gateway Subnet | `10.1.255.0/27` |
| Azure Firewall Subnet | `10.1.1.0/26` |

The address space is isolated from spoke VNets and on-prem networks to avoid overlap.

---

## Hub VNet Components

### 1. Azure VPN Gateway

- Type: Route-based VPN Gateway
- Purpose:
  - Terminates the Site-to-Site IPsec VPN
  - Enables secure connectivity with on-premises RRAS
- Deployed in the **GatewaySubnet**

The VPN Gateway serves as the **entry and exit point** for all hybrid traffic.

---

### 2. Azure Firewall

- Deployed in the **AzureFirewallSubnet**
- Acts as the **central traffic inspection point**
- Inspects:
  - Spoke-to-spoke traffic
  - Spoke-to-on-prem traffic
  - On-prem-to-Azure traffic

Azure Firewall ensures that only explicitly allowed traffic is permitted.

---

### 3. Azure Firewall Policy

- Defines network access rules
- Controls permitted traffic flows between:
  - App VNet and On-Prem
  - Management VNet and App VNet
  - Management VNet and On-Prem
- Enforces deny-by-default behavior

Policies are applied consistently across the hybrid environment.

---

## Routing Role of the Hub VNet

The Hub VNet functions as the **mandatory transit network**.

Routing is enforced using:

- VNet peering between Hub and Spokes
- User Defined Routes (UDRs) in spoke VNets
- Azure Firewall as the next hop for outbound traffic

This ensures:
- No direct spoke-to-spoke routing
- No direct spoke-to-on-prem routing
- All traffic is inspected centrally

---

## Traffic Flow Through the Hub

Example traffic paths:

- App VNet → Hub → Azure Firewall → VPN Gateway → On-Prem
- Management VNet → Hub → Azure Firewall → App VNet
- Management VNet → Hub → Azure Firewall → VPN Gateway → On-Prem

All traffic is subject to firewall inspection and policy enforcement.

---

## Validation

The Hub VNet configuration is validated by:

- Confirming VPN Gateway connectivity status
- Monitoring Azure Firewall metrics and logs
- Verifying that all spoke traffic passes through the firewall
- Testing permitted and blocked traffic paths

---

## Outcome

The Azure Hub VNet provides a **secure, centralized, and scalable foundation** for hybrid connectivity. It ensures consistent security enforcement, simplified routing management, and enterprise-grade control over all network traffic.
